<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Daily Challenges - Investing101</title>
  <link rel="stylesheet" href="dist/main.css">
  <script src="device-detection.js"></script>
  <script src="gamification-widget.js"></script>
  <script>
    (function(){
      try {
        var supported = ['light','dark','ultradark','emerald-trust','quantum-violet','copper-balance','regal-portfolio','carbon-edge'];
        var alias = { sepia: 'copper-balance' };
        var stored = localStorage.getItem('inv101_theme');
        var legacy = localStorage.getItem('darkMode') === 'true' ? 'dark' : null;
        var theme = (stored || legacy || 'light').toLowerCase();
        if (theme.indexOf('theme-') === 0) theme = theme.slice(6);
        if (alias[theme]) theme = alias[theme];
        if (supported.indexOf(theme) === -1) theme = 'light';
        var root = document.documentElement;
        var purge = ['dark-mode','theme-sepia'];
        supported.forEach(function(id){ purge.push('theme-' + id); });
        purge.forEach(function(cls){ root.classList.remove(cls); });
        root.classList.add('theme-' + theme);
      } catch (e) {}
    })();
  </script>
</head>
<body class="bg-white dark:bg-slate-950">
  <script src="global-ui.js"></script>
  <div class="flex min-h-screen flex-col">
    <header class="flex items-center justify-between border-b border-slate-200 bg-white px-6 py-4 dark:border-slate-800 dark:bg-slate-900">
      <a class="link-button" href="index.html">‚Üê Back</a>
      <h1 class="text-xl font-bold">Daily Challenges</h1>
      <span></span>
    </header>

    <main class="flex-1 overflow-auto pb-20">
      <!-- Daily Challenge Hero -->
      <div class="px-6 py-8 bg-gradient-to-br from-primary-green via-emerald-600 to-teal-600 text-white">
        <div class="max-w-2xl mx-auto text-center">
          <h2 class="text-3xl font-bold mb-2">Today's Challenge</h2>
          <p class="text-emerald-100">Complete challenges to earn bonus XP and climb the leaderboard!</p>
        </div>
      </div>

      <!-- Daily Challenge Card -->
      <div class="px-6 py-4">
        <div id="dailyChallengeCard" class="card bg-gradient-to-br from-white to-slate-50 dark:from-slate-900 dark:to-slate-800 border-2 border-primary-green shadow-xl">
          <div id="dailyChallengeLoading" class="text-center py-8">
            <div class="inline-block animate-spin rounded-full h-12 w-12 border-4 border-slate-300 border-t-primary-green"></div>
            <p class="mt-4">Loading today's challenge...</p>
          </div>

          <div id="dailyChallengeContent" style="display: none;">
            <div class="flex items-start justify-between mb-4">
              <div class="flex-1">
                <div class="flex items-center gap-2 mb-2">
                  <span class="px-3 py-1 bg-primary-green text-white text-xs font-bold rounded-full">DAILY</span>
                  <span class="px-3 py-1 bg-amber-500 text-white text-xs font-bold rounded-full" id="dailyBonus">2X XP</span>
                </div>
                <h3 class="text-2xl font-bold mb-2" id="dailyTitle">-</h3>
                <p class="text-slate-600 dark:text-slate-400" id="dailyDescription">-</p>
              </div>
              <div class="text-right">
                <div class="text-3xl mb-2" id="dailyEmoji">üéØ</div>
                <div class="text-sm text-slate-600 dark:text-slate-400">Reward</div>
                <div class="text-xl font-bold text-primary-green" id="dailyReward">+0 XP</div>
              </div>
            </div>

            <!-- Progress Bar -->
            <div class="mb-4">
              <div class="flex justify-between text-sm mb-2">
                <span class="font-semibold">Progress</span>
                <span class="font-bold text-primary-green"><span id="dailyCurrent">0</span> / <span id="dailyTarget">0</span></span>
              </div>
              <div class="w-full h-4 bg-slate-200 dark:bg-slate-700 rounded-full overflow-hidden">
                <div id="dailyProgressBar" class="h-full bg-gradient-to-r from-primary-green to-emerald-600 transition-all duration-300" style="width: 0%"></div>
              </div>
            </div>

            <!-- Status -->
            <div id="dailyCompleted" class="flex items-center justify-center gap-2 p-4 bg-green-50 dark:bg-green-900/20 border-2 border-green-500 rounded-lg" style="display: none;">
              <svg class="w-6 h-6 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
              <span class="text-lg font-bold text-green-600 dark:text-green-400">Challenge Completed! üéâ</span>
            </div>

            <div id="dailyInProgress" class="flex items-center justify-between" style="display: none;">
              <div class="text-sm text-slate-600 dark:text-slate-400">
                Keep going! You're <span id="dailyProgressPercent">0</span>% there.
              </div>
              <button onclick="refreshChallenges()" class="px-4 py-2 bg-primary-green text-white rounded-lg hover:bg-emerald-600 transition">
                Refresh Progress
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Active Challenges -->
      <div class="px-6 py-4">
        <h3 class="text-xl font-bold mb-4">Active Challenges</h3>
        
        <div id="activeChallengesLoading" class="text-center py-8">
          <p class="text-slate-600 dark:text-slate-400">Loading challenges...</p>
        </div>

        <div id="activeChallengesList" class="grid gap-4" style="display: none;">
          <!-- Populated by JavaScript -->
        </div>

        <div id="noChallenges" class="text-center py-12" style="display: none;">
          <div class="text-6xl mb-4">üéØ</div>
          <p class="text-lg font-semibold text-slate-700 dark:text-slate-300">No active challenges right now</p>
          <p class="text-sm text-slate-500 dark:text-slate-400 mt-2">Check back tomorrow for new challenges!</p>
        </div>
      </div>

      <!-- Stats Section -->
      <div class="px-6 py-4">
        <div class="card bg-slate-50 dark:bg-slate-800/50">
          <h3 class="text-lg font-bold mb-4">Your Challenge Stats</h3>
          <div class="grid grid-cols-2 gap-4">
            <div class="text-center">
              <div class="text-3xl font-bold text-primary-green" id="completedCount">0</div>
              <div class="text-sm text-slate-600 dark:text-slate-400">Completed</div>
            </div>
            <div class="text-center">
              <div class="text-3xl font-bold text-amber-500" id="totalXPEarned">0</div>
              <div class="text-sm text-slate-600 dark:text-slate-400">XP Earned</div>
            </div>
          </div>
        </div>
      </div>

      <!-- How it Works -->
      <div class="px-6 py-4">
        <div class="card border-2 border-blue-200 dark:border-blue-900">
          <h3 class="text-lg font-bold mb-3 flex items-center gap-2">
            <svg class="w-5 h-5 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
            How Challenges Work
          </h3>
          <ul class="space-y-2 text-sm text-slate-600 dark:text-slate-400">
            <li class="flex items-start gap-2">
              <span class="text-primary-green">‚Ä¢</span>
              <span>New daily challenges appear every 24 hours</span>
            </li>
            <li class="flex items-start gap-2">
              <span class="text-primary-green">‚Ä¢</span>
              <span>Complete challenges to earn bonus XP (often 2X or more!)</span>
            </li>
            <li class="flex items-start gap-2">
              <span class="text-primary-green">‚Ä¢</span>
              <span>Track your progress in real-time as you learn</span>
            </li>
            <li class="flex items-start gap-2">
              <span class="text-primary-green">‚Ä¢</span>
              <span>Complete challenges to climb the leaderboard faster</span>
            </li>
          </ul>
        </div>
      </div>
    </main>

    <!-- Bottom Navigation -->
    <nav class="fixed bottom-0 left-0 right-0 flex border-t border-slate-200 bg-white dark:border-slate-800 dark:bg-slate-900" aria-label="Primary navigation">
      <a class="flex-1 flex flex-col items-center justify-center gap-1 border-r border-slate-200 px-2 py-3 text-sm font-semibold text-slate-600 transition hover:bg-slate-50 hover:text-primary-green dark:border-slate-800 dark:text-slate-300 dark:hover:bg-slate-900 dark:hover:text-primary-green" href="index.html">
        <svg class="icon icon--tab" viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-home"></use></svg>
        <span>Main</span>
      </a>
      <a class="flex-1 flex flex-col items-center justify-center gap-1 border-r border-slate-200 px-2 py-3 text-sm font-semibold text-slate-600 transition hover:bg-slate-50 hover:text-primary-green dark:border-slate-800 dark:text-slate-300 dark:hover:bg-slate-900 dark:hover:text-primary-green" href="simulator.html">
        <svg class="icon icon--tab" viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-sim"></use></svg>
        <span>Sim/AI</span>
      </a>
      <a class="flex-1 flex flex-col items-center justify-center gap-1 border-r border-slate-200 px-2 py-3 text-sm font-semibold text-slate-600 transition hover:bg-slate-50 hover:text-primary-green dark:border-slate-800 dark:text-slate-300 dark:hover:bg-slate-900 dark:hover:text-primary-green" href="lessons.html">
        <svg class="icon icon--tab" viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-lessons"></use></svg>
        <span>Lessons</span>
      </a>
      <a class="flex-1 flex flex-col items-center justify-center gap-1 border-r border-slate-200 px-2 py-3 text-sm font-semibold text-slate-600 transition hover:bg-slate-50 hover:text-primary-green dark:border-slate-800 dark:text-slate-300 dark:hover:bg-slate-900 dark:hover:text-primary-green" href="calculators.html">
        <svg class="icon icon--tab" viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-calc"></use></svg>
        <span>Calc</span>
      </a>
      <a class="flex-1 flex flex-col items-center justify-center gap-1 px-2 py-3 text-sm font-semibold tabbar__btn--active" href="profile.html">
        <svg class="icon icon--tab" viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-profile"></use></svg>
        <span>Profile</span>
      </a>
    </nav>
  </div>

  <script src="challenges.js"></script>
</body>
</html>
