<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Sign In - Investing101</title>
	<link rel="stylesheet" href="styles.css">
	<style>
		:root {
			--signin-bg: linear-gradient(135deg, #04131d, #0f4c3a 58%, #0fa36b);
			--signin-card-bg: rgba(10, 21, 28, 0.92);
			--signin-hero-glow: rgba(53, 235, 178, 0.35);
			--signin-input-bg: rgba(8, 21, 28, 0.75);
			--signin-border: rgba(255, 255, 255, 0.08);
			--signin-muted: rgba(224, 236, 231, 0.72);
			--signin-primary: #2dd4bf;
			--signin-primary-dark: #0f8a5f;
		}

		*,
		*::before,
		*::after {
			box-sizing: border-box;
		}

		html,
		body {
			height: 100%;
			margin: 0;
		}

		body.signin-page {
			min-height: 100vh;
			display: flex;
			align-items: center;
			justify-content: center;
			background: var(--signin-bg);
			color: #f2fbf7;
			font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
			position: relative;
			overflow: hidden;
		}

		body.signin-page::before,
		body.signin-page::after {
			content: "";
			position: absolute;
			width: 420px;
			height: 420px;
			border-radius: 50%;
			background: radial-gradient(circle at center, var(--signin-hero-glow), rgba(5, 24, 34, 0));
			z-index: 0;
		}

		body.signin-page::before {
			top: -120px;
			left: -140px;
		}

		body.signin-page::after {
			bottom: -160px;
			right: -140px;
		}

		/* Floating orbs animation */
		.floating-orb {
			position: absolute;
			border-radius: 50%;
			background: radial-gradient(circle at 30% 30%, rgba(53, 235, 178, 0.4), rgba(45, 212, 191, 0.15), transparent);
			filter: blur(40px);
			pointer-events: none;
			z-index: 0;
		}

		.floating-orb-1 {
			width: 300px;
			height: 300px;
			top: 10%;
			left: 5%;
			animation: float-1 20s ease-in-out infinite;
		}

		.floating-orb-2 {
			width: 200px;
			height: 200px;
			top: 60%;
			right: 10%;
			animation: float-2 15s ease-in-out infinite;
		}

		.floating-orb-3 {
			width: 250px;
			height: 250px;
			bottom: 15%;
			left: 15%;
			animation: float-3 18s ease-in-out infinite;
		}

		.floating-orb-4 {
			width: 150px;
			height: 150px;
			top: 30%;
			right: 20%;
			animation: float-4 12s ease-in-out infinite;
		}

		.floating-orb-5 {
			width: 180px;
			height: 180px;
			bottom: 30%;
			right: 5%;
			animation: float-5 16s ease-in-out infinite;
		}

		@keyframes float-1 {
			0%, 100% { transform: translate(0, 0) scale(1); opacity: 0.3; }
			25% { transform: translate(30px, -40px) scale(1.1); opacity: 0.5; }
			50% { transform: translate(-20px, -80px) scale(0.9); opacity: 0.4; }
			75% { transform: translate(40px, -40px) scale(1.05); opacity: 0.45; }
		}

		@keyframes float-2 {
			0%, 100% { transform: translate(0, 0) scale(1); opacity: 0.35; }
			30% { transform: translate(-40px, 30px) scale(1.15); opacity: 0.5; }
			60% { transform: translate(20px, 60px) scale(0.95); opacity: 0.4; }
			80% { transform: translate(-30px, 20px) scale(1.1); opacity: 0.45; }
		}

		@keyframes float-3 {
			0%, 100% { transform: translate(0, 0) scale(1); opacity: 0.4; }
			20% { transform: translate(50px, 30px) scale(1.1); opacity: 0.55; }
			50% { transform: translate(-30px, -20px) scale(0.9); opacity: 0.45; }
			70% { transform: translate(40px, 10px) scale(1.05); opacity: 0.5; }
		}

		@keyframes float-4 {
			0%, 100% { transform: translate(0, 0) scale(1); opacity: 0.3; }
			35% { transform: translate(-25px, -50px) scale(1.2); opacity: 0.5; }
			65% { transform: translate(35px, 40px) scale(0.85); opacity: 0.35; }
			85% { transform: translate(-20px, -30px) scale(1.1); opacity: 0.45; }
		}

		@keyframes float-5 {
			0%, 100% { transform: translate(0, 0) scale(1); opacity: 0.35; }
			25% { transform: translate(45px, -35px) scale(1.15); opacity: 0.5; }
			55% { transform: translate(-35px, 25px) scale(0.9); opacity: 0.4; }
			75% { transform: translate(30px, -20px) scale(1.05); opacity: 0.45; }
		}

		.signin-shell {
			position: relative;
			width: min(1050px, 92vw);
			min-height: clamp(520px, 70vh, 680px);
			display: flex;
			background: rgba(3, 13, 18, 0.68);
			border: 1px solid rgba(255, 255, 255, 0.06);
			border-radius: 28px;
			box-shadow: 0 34px 60px rgba(7, 24, 20, 0.45);
			backdrop-filter: blur(22px);
			overflow: hidden;
			z-index: 1;
		}

		.signin-hero {
			flex: 1.1;
			display: flex;
			flex-direction: column;
			justify-content: space-between;
			gap: clamp(32px, 6vw, 48px);
			padding: clamp(42px, 6vw, 58px);
			border-right: 1px solid rgba(255, 255, 255, 0.06);
			background: linear-gradient(145deg, rgba(11, 32, 40, 0.9), rgba(5, 24, 34, 0.65));
			position: relative;
		}

		.signin-hero::after {
			content: "";
			position: absolute;
			inset: 36px;
			border-radius: 24px;
			background: radial-gradient(circle at top right, rgba(53, 235, 178, 0.19), rgba(14, 44, 52, 0));
			pointer-events: none;
			z-index: 0;
		}

		.signin-hero > * {
			position: relative;
			z-index: 1;
		}

		.signin-brand {
			display: flex;
			align-items: center;
			gap: 14px;
			font-size: 0.95rem;
			letter-spacing: 0.08em;
			text-transform: uppercase;
			color: rgba(173, 241, 226, 0.78);
		}

		.signin-brand-badge {
			display: inline-flex;
			align-items: center;
			justify-content: center;
			width: 48px;
			height: 48px;
			border-radius: 14px;
			background: rgba(45, 212, 191, 0.18);
			border: 1px solid rgba(45, 212, 191, 0.32);
			font-weight: 600;
			color: #8dfbe1;
		}

		.signin-brand-label {
			display: flex;
			flex-direction: column;
			gap: 4px;
			font-size: 0.8rem;
			letter-spacing: 0.12em;
		}

		.signin-brand-label span:first-child {
			font-weight: 600;
			letter-spacing: 0.18em;
		}

		.signin-brand-label span:last-child {
			font-size: 0.78rem;
			letter-spacing: 0.28em;
			opacity: 0.7;
		}

		.signin-hero h1 {
			margin: clamp(28px, 4vw, 44px) 0 clamp(26px, 3vw, 36px);
			font-size: clamp(2.2rem, 3.4vw, 2.7rem);
			font-weight: 700;
			letter-spacing: -0.01em;
			line-height: 1.12;
		}

		.signin-summary {
			display: grid;
			gap: clamp(18px, 2.4vw, 28px);
			color: var(--signin-muted);
			font-size: clamp(0.95rem, 1.2vw, 1.05rem);
		}

		.signin-summary-item {
			display: flex;
			align-items: flex-start;
			gap: 12px;
		}

		.signin-summary-icon {
			width: 28px;
			height: 28px;
			border-radius: 10px;
			background: rgba(45, 212, 191, 0.22);
			border: 1px solid rgba(45, 212, 191, 0.28);
			display: inline-flex;
			align-items: center;
			justify-content: center;
			color: #0f8a5f;
			font-size: 0.85rem;
			font-weight: 700;
		}

		.signin-summary-text strong {
			display: block;
			color: #ecfff8;
			font-size: clamp(1.05rem, 1.3vw, 1.2rem);
		}

		.signin-cta-note {
			margin: 0;
			font-size: 0.95rem;
			color: rgba(220, 240, 233, 0.78);
		}

		.signin-cta-note a {
			color: #9fffe4;
			font-weight: 600;
			text-decoration: none;
		}

		.signin-cta-note a:hover {
			text-decoration: underline;
		}

		.signin-card {
			flex: 0.9;
			background: var(--signin-card-bg);
			padding: clamp(36px, 6vw, 64px);
			display: flex;
			flex-direction: column;
			justify-content: center;
			gap: clamp(28px, 4vw, 42px);
		}

		.signin-card header {
			display: flex;
			flex-direction: column;
			gap: 12px;
		}

		.signin-card h2 {
			margin: 0;
			font-size: clamp(1.8rem, 2.4vw, 2.1rem);
			font-weight: 700;
			letter-spacing: -0.01em;
		}

		.signin-card p {
			margin: 0;
			color: var(--signin-muted);
			font-size: clamp(0.95rem, 1.2vw, 1.05rem);
		}

		form#signinForm {
			display: grid;
			gap: 20px;
		}

		.signin-field {
			display: grid;
			gap: 8px;
		}

		.signin-field label {
			font-size: 0.95rem;
			font-weight: 600;
			letter-spacing: 0.01em;
		}

		.signin-field input[type="email"],
		.signin-field input[type="password"] {
			width: 100%;
			border-radius: 12px;
			border: 1px solid var(--signin-border);
			background: var(--signin-input-bg);
			padding: 14px 16px;
			font-size: 1.02rem;
			color: #f4fff9;
			transition: border-color 0.2s ease, box-shadow 0.2s ease;
		}

		.signin-field input:focus {
			outline: none;
			border-color: rgba(45, 212, 191, 0.55);
			box-shadow: 0 0 0 4px rgba(45, 212, 191, 0.18);
		}

		.signin-controls {
			display: flex;
			justify-content: space-between;
			align-items: center;
			flex-wrap: wrap;
			gap: 16px;
		}

		.signin-remember {
			display: flex;
			align-items: center;
			gap: 10px;
			font-size: 0.95rem;
			color: var(--signin-muted);
		}

		.signin-remember input[type="checkbox"] {
			width: 18px;
			height: 18px;
			accent-color: var(--signin-primary);
		}

		.signin-button {
			flex-shrink: 0;
			display: inline-flex;
			align-items: center;
			justify-content: center;
			padding: 14px 26px;
			border: none;
			border-radius: 999px;
			background: linear-gradient(135deg, var(--signin-primary), var(--signin-primary-dark));
			font-size: 1.05rem;
			font-weight: 600;
			color: #041414;
			cursor: pointer;
			box-shadow: 0 14px 28px rgba(45, 212, 191, 0.26);
			transition: transform 0.2s ease, box-shadow 0.2s ease;
		}

		.signin-button:hover {
			transform: translateY(-1px);
			box-shadow: 0 18px 32px rgba(45, 212, 191, 0.32);
		}

		.signin-button:active {
			transform: translateY(1px);
		}

		.signin-status {
			min-height: 1.2em;
			font-size: 0.95rem;
			color: var(--signin-muted);
		}

		.signin-status[data-state="error"] {
			color: #f89f9f;
		}

		.signin-status[data-state="success"] {
			color: #7dfcd7;
		}

		.signin-status[data-state="info"] {
			color: rgba(141, 255, 225, 0.85);
		}

		.signin-divider {
			position: relative;
			text-align: center;
			font-size: 0.9rem;
			color: var(--signin-muted);
		}

		.signin-divider::before,
		.signin-divider::after {
			content: "";
			position: absolute;
			top: 50%;
			width: 42%;
			height: 1px;
			background: rgba(255, 255, 255, 0.08);
		}

		.signin-divider::before {
			left: 0;
		}

		.signin-divider::after {
			right: 0;
		}

		.signin-socials {
			display: grid;
			gap: 14px;
		}

		.signin-socials button {
			display: flex;
			align-items: center;
			justify-content: center;
			gap: 12px;
			padding: 12px;
			border-radius: 12px;
			border: 1px solid rgba(255, 255, 255, 0.12);
			background: rgba(8, 21, 28, 0.68);
			color: #f5fff9;
			font-size: 0.98rem;
			cursor: pointer;
			transition: transform 0.2s ease, border-color 0.2s ease;
		}

		.signin-socials button svg {
			flex-shrink: 0;
		}

		.signin-socials button:hover {
			transform: translateY(-1px);
			border-color: rgba(45, 212, 191, 0.3);
		}

		.signin-alt {
			margin-top: 8px;
			font-size: 0.95rem;
			color: var(--signin-muted);
			text-align: center;
		}

		.signin-alt a {
			color: #8dfbe1;
			font-weight: 600;
			text-decoration: none;
		}

		.signin-alt a:hover {
			text-decoration: underline;
		}

		/* Guest mode button */
		.signin-guest {
			margin-top: 20px;
			padding: 12px 20px;
			background: rgba(45, 212, 191, 0.08);
			border: 1px solid rgba(45, 212, 191, 0.25);
			border-radius: 12px;
			color: rgba(173, 241, 226, 0.9);
			font-size: 0.95rem;
			cursor: pointer;
			transition: all 0.2s ease;
			width: 100%;
			font-weight: 500;
		}

		.signin-guest:hover {
			background: rgba(45, 212, 191, 0.15);
			border-color: rgba(45, 212, 191, 0.4);
			transform: translateY(-1px);
		}

		@media (max-width: 960px) {
			.signin-shell {
				flex-direction: column;
				min-height: auto;
			}

			.signin-hero {
				border-right: none;
				border-bottom: 1px solid rgba(255, 255, 255, 0.06);
				text-align: center;
				align-items: center;
				gap: 24px;
			}

			.signin-summary {
				grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
			}

			.signin-summary-item {
				justify-content: center;
			}
		}

		@media (max-width: 620px) {
			.signin-shell {
				width: min(520px, 100vw);
				border-radius: 0;
				min-height: 100vh;
			}

			.signin-card {
				padding: clamp(28px, 8vw, 40px);
			}

			.signin-controls {
				flex-direction: column;
				align-items: stretch;
			}

			.signin-button {
				width: 100%;
			}
		}
	</style>
</head>
<body class="signin-page">
	<!-- Floating animated orbs -->
	<div class="floating-orb floating-orb-1"></div>
	<div class="floating-orb floating-orb-2"></div>
	<div class="floating-orb floating-orb-3"></div>
	<div class="floating-orb floating-orb-4"></div>
	<div class="floating-orb floating-orb-5"></div>
	
	<div class="signin-shell">
		<section class="signin-hero">
			<header class="signin-brand">
				<img src="assets/Investing101.png" alt="Investing101" class="signin-brand-logo" style="height: 48px; width: auto; border-radius: 8px;">
				<span class="signin-brand-label">
					<span>Investing101</span>
					<span>Terminal Access</span>
				</span>
			</header>
			<div>
				<h1>Sign in to continue tracking smarter financial moves.</h1>
				<div class="signin-summary">
					<div class="signin-summary-item">
						<span class="signin-summary-icon" aria-hidden="true">â–²</span>
						<div class="signin-summary-text">
							<strong>Live Market Signals</strong>
							<span>Stay ahead with curated movers and projections delivered daily.</span>
						</div>
					</div>
					<div class="signin-summary-item">
						<span class="signin-summary-icon" aria-hidden="true">â˜…</span>
						<div class="signin-summary-text">
							<strong>Personalized Insights</strong>
							<span>Sync preferences and pick up right where you left off.</span>
						</div>
					</div>
				</div>
			</div>
			<p class="signin-cta-note">Need an account? <a href="signup.html">Create one in minutes</a>.</p>
		</section>
		<section class="signin-card">
			<header>
				<h2>Welcome back</h2>
				<p>Log in to access your dashboard, newsletter preferences, and saved simulations.</p>
			</header>
			<form id="signinForm" novalidate>
				<div class="signin-field">
					<label for="signin-email">Email</label>
					<input id="signin-email" type="email" name="email" placeholder="you@example.com" autocomplete="email" required>
				</div>
				<div class="signin-field">
					<label for="signin-password">Password</label>
					<input id="signin-password" type="password" name="password" placeholder="Enter your password" autocomplete="current-password" required>
				</div>
				<div class="signin-controls">
					<label class="signin-remember">
						<input type="checkbox" name="remember" value="1">
						<span>Keep me logged in</span>
					</label>
					<button class="signin-button" type="submit">Continue</button>
				</div>
				<p class="signin-status" id="signinStatus" aria-live="polite"></p>
			</form>
			<div class="signin-divider">or continue with</div>
			<div class="signin-socials">
				<button type="button" onclick="window.location.href='/auth/google'">
					<svg width="18" height="18" viewBox="0 0 18 18" aria-hidden="true">
						<path fill="#EA4335" d="M9 7.2v3.6h5.1c-.2 1.2-.9 2.3-1.9 3l3.1 2.4c1.8-1.7 2.8-4.1 2.8-6.8 0-.7-.1-1.3-.2-1.9H9z"/>
						<path fill="#34A853" d="M4.3 10.7l-.7.5-2.5 1.9C2.8 15.9 5.7 17.7 9 17.7c2.4 0 4.4-.8 5.9-2.3l-3.1-2.4c-.8.5-1.8.8-2.8.8-2.1 0-3.8-1.4-4.4-3.2z"/>
						<path fill="#4285F4" d="M16.9 5.4l-3.1 2.4c-.4-1.1-1.2-2-2.3-2.5-.9-.4-1.8-.6-2.8-.6-3.3 0-6.2 1.8-7.7 4.5l3.2 2.4c.6-1.8 2.3-3.2 4.4-3.2 1 0 1.9.3 2.8.8.8.5 1.5 1.2 1.9 2.1l3.1-2.4z"/>
						<path fill="#FBBC05" d="M1.6 5.9l3.2 2.4c-.2.5-.3 1-.3 1.5s.1 1 .3 1.5l-3.2 2.4C.9 12.6.6 11.3.6 9.8c0-1.5.3-2.8 1-3.9z"/>
					</svg>
					Google
				</button>
				<button type="button" onclick="window.location.href='/auth/facebook'">
					<svg width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
						<path fill="#1877F2" d="M22 12.1C22 6.6 17.5 2 12 2S2 6.6 2 12.1c0 5 3.7 9.1 8.5 9.9v-7H8v-3h2.5V9.9c0-2.5 1.5-3.9 3.7-3.9 1.1 0 2.2.2 2.2.2v2.4h-1.3c-1.3 0-1.7.8-1.7 1.6v1.9H18l-.4 3h-2.9v7c4.8-.8 8.3-4.9 8.3-9.9z"/>
					</svg>
					Facebook
				</button>
			</div>
			<button type="button" class="signin-guest" onclick="continueAsGuest()">
				<span>ðŸš€ Continue as Guest</span>
			</button>
			<div class="signin-alt">
				<span>Prefer to explore first?</span>
				<a href="/">Return to overview</a>
			</div>
		</section>
	</div>

	<script>
		(function () {
			const form = document.getElementById('signinForm');
			const statusEl = document.getElementById('signinStatus');

			function setStatus(message, state) {
				if (!statusEl) return;
				statusEl.textContent = message || '';
				if (state) {
					statusEl.setAttribute('data-state', state);
				} else {
					statusEl.removeAttribute('data-state');
				}
			}

			async function checkExistingSession() {
				try {
					const response = await fetch('/api/auth/me', { credentials: 'include' });
					if (!response.ok) return;
					const payload = await response.json();
					if (payload?.success) {
						window.location.href = '/profile.html';
					}
				} catch (error) {
					console.warn('Session check failed:', error);
				}
			}

			// Check for OAuth errors in URL
			function checkOAuthErrors() {
				const urlParams = new URLSearchParams(window.location.search);
				const error = urlParams.get('error');
				
				if (error) {
					let errorMessage = 'Authentication failed. Please try again.';
					if (error === 'google_auth_failed') {
						errorMessage = 'Google sign-in failed. Please check your Google account and try again.';
					} else if (error === 'facebook_auth_failed') {
						errorMessage = 'Facebook sign-in failed. Please check your Facebook account and try again.';
					} else if (error === 'oauth_failed') {
						errorMessage = 'OAuth sign-in failed. Please try a different method.';
					}
					
					setStatus(errorMessage, 'error');
					
					// Clean up URL
					window.history.replaceState({}, document.title, window.location.pathname);
				}
			}

			form.addEventListener('submit', async (event) => {
				event.preventDefault();
				const formData = new FormData(form);
				const email = String(formData.get('email') || '').trim();
				const password = String(formData.get('password') || '');
				const rememberMe = formData.get('remember') === '1';

				if (!email || !password) {
					setStatus('Email and password are required.', 'error');
					return;
				}

				setStatus('Signing in...', 'info');

				try {
					const response = await fetch('/api/auth/login', {
						method: 'POST',
						headers: {
							'Content-Type': 'application/json'
						},
						credentials: 'include',
						body: JSON.stringify({ email, password, rememberMe })
					});

					const payload = await response.json().catch(() => ({}));
					if (!response.ok || !payload?.success) {
						throw new Error(payload?.error || 'Unable to sign in. Check your credentials and try again.');
					}

					setStatus('Signed in! Redirecting...', 'success');
					// Redirect to profile page after successful login
					setTimeout(() => {
						window.location.href = '/profile.html';
					}, 500);
				} catch (error) {
					console.error('Sign in failed:', error);
					setStatus(error.message || 'Unable to sign in right now.', 'error');
				}
			});

			checkExistingSession();
			checkOAuthErrors();
		})();

		// Guest mode functionality
		function continueAsGuest() {
			try {
				// Create a guest user ID
				const guestId = 'guest_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
				
				// Store guest session in localStorage
				const guestSession = {
					id: guestId,
					displayName: 'Guest User',
					email: null,
					isGuest: true,
					createdAt: new Date().toISOString(),
					portfolio: {
						totalValue: 10000, // Starting balance
						cash: 10000,
						holdings: []
					}
				};
				
				localStorage.setItem('inv101_guest_session', JSON.stringify(guestSession));
				localStorage.setItem('inv101_guest_mode', 'true');
				
				// Show a welcome message
				alert('Welcome! You\'re browsing as a guest. Your progress will be saved locally.\n\nCreate an account later to access your data across devices and unlock social features!');
				
				// Redirect to main page
				window.location.href = '/index.html';
			} catch (error) {
				console.error('Guest mode error:', error);
				alert('Unable to continue as guest. Please try again.');
			}
		}
	</script>
</body>
</html>


